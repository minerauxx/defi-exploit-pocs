## DeFi Exploit POCs

A collection of POCs that I did in the past, mainly for my own learning purposes.

Generally retraces the steps of the actual exploit transactions performed by attackers. My tools of choices were usually
[Etherscan](https://etherscan.io/), [BlockSec](https://tools.blocksec.com/tx), and [Tenderly](https://tenderly.co/). See source files for tx hashes.

To run, install [foundry](https://github.com/foundry-rs/foundry), and set the env vars needed in `foundry.toml`. I use [Alchemy](https://www.alchemy.com/) for RPC.

Example for running with traces:

`forge test --match-contract AudiusTest --etherscan-api-key $ETHERSCAN_API_KEY -vvvv`

### Audius

`forge test --match-contract AudiusTest`

Bug: Storage collision

#### References:

- https://blog.audius.co/article/audius-governance-takeover-post-mortem-7-23-22
- https://twitter.com/Zellic_io/status/1552317415261962246

### Beanstalk

`forge test --match-contract BeanstalkTest`

Bug: Governance + flashloan

#### References:

- https://rekt.news/beanstalk-rekt/
- https://medium.com/coinmonks/beanstalk-exploit-a-simplified-post-mortem-analysis-92e6cdb17ace
- https://web.archive.org/web/20220422185410/https://medium.com/@omniscia.io/beanstalk-farms-post-mortem-analysis-a0667ee0ca9d

### Inverse

`forge test --match-contract InverseTest`

Bug: Oracle price manipulation

#### References:

- https://rekt.news/inverse-rekt2/
- https://www.inverse.finance/blog/posts/en-US/june-16-incident-summary

### Pickle

`forge test --match-contract PickleTest`

Bug: Input validation

#### References:

- https://rekt.news/pickle-finance-rekt/
- https://peckshield.medium.com/pickle-incident-root-cause-analysis-5d73496ebc9f
- https://github.com/banteg/evil-jar

### Popsicle

`forge test --match-contract PopsicleTest`

Bug: Accounting logic

#### References:

- https://rekt.news/popsicle-rekt/
- https://twitter.com/peckshield/status/1422776188913819648?s=20
- https://twitter.com/Mudit__Gupta/status/1422797923037814786

### Rari

`forge test --match-contract RariTest`

Bug: Re-entrancy

#### References:

- https://rekt.news/fei-rari-rekt/
- https://rari-hack-report.vercel.app/
- https://twitter.com/Hacxyk/status/1520370421773725698

### Revest

`forge test --match-contract RevestTest`

Bug: Re-entrancy

#### References:

- https://rekt.news/revest-finance-rekt/
- https://revestfinance.medium.com/revest-protocol-exploit-recovery-plan-b06ca33fbdf5
- https://twitter.com/BlockSecTeam/status/1508065573250678793

### Superfluid

`forge test --match-contract SuperfluidTest`

Bug: Input validation

#### References:

- https://rekt.news/superfluid-rekt/
- https://medium.com/superfluid-blog/08-02-22-exploit-post-mortem-15ff9c97cdd
